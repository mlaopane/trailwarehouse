{# TrailWarehouse > AppBundle > Resources > views > Shop > family.html.twig #}

{% extends "TrailWarehouseAppBundle::layout.html.twig" %}


{% block title %}
  {{ parent() }} : Mon panier
{% endblock %}

{% block javascripts %}
  {{ parent() }}
  <script src="{{ asset('bower_components/angular/angular.min.js') }}"></script>
{% endblock %}

{% block page_main %}
  <main id="page-cart" class="page-content bg-white">

      <div id="ng-data">
        <input type ="hidden" data-ng-init="page.SHOP_URL  = '{{ url('app_shop') }}'">
        <input type ="hidden" data-ng-init="page.CART_URL  = '{{ url('app_cart') }}'">
        <input type ="hidden" data-ng-init="page.API_URL   = '{{ url('app_api_product_get_all') }}'">
        <input type ="hidden" data-ng-init="page.ASSET_URL = '{{ asset('') }}'">
      </div>

      <!-- # Cart -->
      <div id="cart">

        <!-- # Heading -->
        <div class="heading-container heading-container-blue">
          <h3 class="heading">Mon panier</h3>
        </div>
        <!-- Heading # -->

        <div id="cart-content" class="px-4">
          {% set cart = app.session.get('cart') %}
          <!-- # Cart content -->
          {% if cart is empty or cart.items is empty %}
          <div class="pb-4">
            <div class="ness-block warning mx-auto mb-3 d-flex justify-content-center w-50">
              <span>Votre panier est vide</span>
            </div>
            <div class="mx-auto d-flex justify-content-center align-items-baseline">
              Accédez à la boutique&nbsp;<strong class="font-weight-normal"><a class="font-brand" href="{{ path('app_home') }}">Trail Warehouse</a></strong>
            </div>
          </div>
          {% else %}
            {% for message in app.flashes('cart_warning') %}
              <div class="ness-block warning mb-3">
                <span>{{ message | raw }}</span>
              </div>
            {% endfor %}
          <!-- # Cart Items -->
          <table id="table-cart" class="ness-table mb-4">
            <thead>
              <tr>
                <th class="">Produit</th>
                <th class="hidden-xs-down">Photo</th>
                <th class="hidden-sm-down">Prix unitaire</th>
                <th class="">Quantité</th>
                <th class="">Sous-total</th>
              </tr>
            </thead>
            <tbody>
              {% for item in cart.items %}
              <tr>
                <td class="text-left">
                  <div class="d-flex flex-column justify-content-center">
                    <a href="#">
                      <div class="">
                        <span class="font-italic">{{ item.product.family.brand.name | ucwords }}</span>
                        <span>{{ item.product.family.name | capitalize }}</span>
                      </div>
                    </a>
                    <span>({{ item.product.size.value | upper }} {{ item.product.size.unitShortcut }} | {{ item.product.color.name | capitalize }})</span>
                  </div>
                </td>
                <td class="text-center hidden-xs-down"><img class="miniature" src="{{ item.product.image is null ? asset('images/no_picture.png') : item.product.image.src }}" alt=""></td>
                <td class="text-right hidden-sm-down">{{ item.product.price }}&nbsp;€</td>
                <td class="text-right">{{ item.quantity }}</td>
                <td class="text-right">{{ item.total }}&nbsp;€</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          <!-- Cart Items # -->

          <div class="row justify-content-between">

            <div class="col-12 col-sm-6 col-md-4">

              <!-- # Promo Code -->
              <div id="cart-promo" class="mx-auto mb-2  d-flex flex-column align-items-start">
                {{ form_start(promo_form) }}
                  <div class="form-group mb-3">
                    {% include 'TrailWarehouseAppBundle:Error:alerts.html.twig' %}
                    {{ form_widget(promo_form.code, {'attr': {'class': 'form-control', 'placeholder': 'Un code promo ?'}}) }}
                  </div>
                  <div class="form-group mb-4">
                    {{ form_widget(promo_form.send, {'attr': {'class':'btn btn-default'}}) }}
                  </div>
                  {{ form_rest(promo_form) }}
                {{ form_end(promo_form) }}
              </div>
              <!-- # Promo Code -->

            </div>

            <div class="col-12 col-sm-6 col-md-4">

              {% if cart.promo is not empty %}
              <div class="ness-block info d-flex justify-content-center mb-2">
                <div>{{ cart.promo.code }} : <span class="font-weight-bold">-&nbsp;{{ cart.promo.value * 100 }}&nbsp;%</span></div>
              </div>
              {% endif %}

              <!-- # Cart Total -->
              <div id="cart-total" class="d-flex flex-column align-items-end mb-3">
                <div>Valeur du panier</div>
                <div class="font-weight-bold lead">{{ cart.total }}&nbsp;&euro;</div>
              </div>
              <!-- Cart Total # -->

              <!-- # Cart Validation -->
              <div id="cart-validation" class="flex justify-content-end mb-2">
                {{ form_start(cart_form, {'attr': {'class':'w-100'}}) }}
                <div class="form-group mb-3">
                  {{ form_widget(cart_form.send, {'attr': {'class': 'ness-btn btn btn-confirm txt-whitegrey w-100'}}) }}
                </div>
                {{ form_end(cart_form) }}
              </div>
              <!-- Cart Validation # -->

            </div>
          </div>
          <!-- Promo Code # -->
          {% endif %}
          <!-- Cart content # -->
        </div>

      </div>
      <!-- Cart # -->

  </main>
{% endblock %}

{% block additional_javascripts %}
  <script src="{{ asset('js/app-common.js') }}"></script>
{% endblock %}
